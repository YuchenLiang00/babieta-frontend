# iOS俄语背单词应用研究报告：第一部分 - 记忆算法

## 1. 遗忘曲线理论基础

### 1.1 艾宾浩斯遗忘曲线

德国心理学家赫尔曼·艾宾浩斯通过自我实验，开创了学习和遗忘的科学研究。其最著名的成果是“遗忘曲线”，它揭示了信息在被记忆后随时间推移而遗忘的规律。

#### 1.1.1 数学模型

艾宾浩斯提出了一个公式来近似描述遗忘曲线：

\[
_R_ = e^{-\frac{t}{S}}
\]

其中：
- **R (Retention)**: 记忆保持率，即记忆内容的剩余百分比。
- **t (Time)**: 自学习以来的时间。
- **S (Strength)**: 记忆的强度，S值越大，记忆保持时间越长。
- **e**: 自然对数的底数。

一个更具体的、在其1885年的出版物中提到的公式是：

\[
b = \frac{100k}{(\log(t))^c + k}
\]

其中：
- **b**: 记忆节省量（Savings），衡量再次学习时节省的时间，可以看作是记忆保持度的一种度量。
- **t**: 时间（分钟）。
- **c** 和 **k**: 为常数，根据实验数据拟合得出（例如 c≈1.25, k≈1.84）。

**核心启示**: 遗忘在记忆之初速度最快，随后逐渐减慢。这意味着，及时的复习对于巩固记忆至关重要。首次复习的时间点尤其关键。

### 1.2 间隔重复系统（Spaced Repetition System, SRS）

基于遗忘曲线理论，间隔重复系统（SRS）被设计出来，其核心思想是：在即将忘记的临界点上进行复习，能够以最高的效率巩固长期记忆。SuperMemo系列算法是SRS中最著名和最受推崇的实现之一。

## 2. SuperMemo SM-2算法详解

SM-2算法是早期SuperMemo软件中使用的核心算法，因其简洁、高效且易于实现，至今仍是许多开源和商业记忆软件的基础。它通过动态调整每个学习项目（单词卡片）的复习间隔和“轻松因子”（Easiness Factor, EF）来实现个性化复习计划。

### 2.1 核心变量

对于每一个需要记忆的单词（item），我们都需要存储以下几个变量：

- **n**: 重复次数（Repetition number）。一个项目被成功复习的次数。初始为0。
- **EF (Easiness Factor)**: 轻松因子。反映了记忆该项目的难易程度。初始值通常设为2.5。EF值越高，意味着该项目越容易记，复习间隔增长得越快。
- **I (Inter-repetition interval)**: 复习间隔。指本次复习与下一次复习之间的时间跨度（天）。

### 2.2 算法流程

算法根据用户对单词的回答质量（Quality of response, `q`）来迭代更新上述变量。

**回答质量 `q` 的定义 (0-5分制):**
- **5**: 完美回忆，毫不费力。
- **4**: 正确回忆，但略有迟疑。
- **3**: 正确回忆，但过程相当困难。
- **2**: 错误回答，但在看到答案后，感觉答案很简单或本应记起。
- **1**: 错误回答，对正确答案没有印象。
- **0**: 完全想不起来，大脑一片空白。

**算法步骤:**

1.  **首次学习**: 用户学习一个新单词。
    -   设置 `n = 1`。
    -   设置 `I(1) = 1` (第二天复习)。

2.  **第二次学习**:
    -   设置 `n = 2`。
    -   设置 `I(2) = 6` (第六天复习)。
    
3.  **第n次复习 (n > 2)**:

    a.  **用户进行复习并评分(q)**。

    b.  **判断复习效果**: 
        -   **如果 `q >= 3` (回答正确):**
            -   **更新轻松因子 (EF'):** 
                \[
                EF' = EF + [0.1 - (5 - q) * (0.08 + (5 - q) * 0.02)]
                \]
                -   如果 `EF'` 小于1.3，则强制设为 `EF' = 1.3`。
            -   **更新重复次数:** `n = n + 1`。
            -   **计算下一次复习间隔:** 
                \[
                I(n) = I(n-1) * EF'
                \]
            -   更新 `EF = EF'`。

        -   **如果 `q < 3` (回答错误):**
            -   **重置重复次数:** `n = 1`。
            -   **重置复习间隔:** `I(1) = 1`。
            -   轻松因子 `EF` 保持不变，以便在后续学习中重新评估其难度。

    c.  **安排下一次复习**: 将该单词的下次复习日期设置为 `今天 + I(n)`。

4.  **复习失败的单词**: 在一次学习会话结束时，所有 `q < 4` 的单词都应该被重新复习，直到用户能至少给出 `q = 4` 的评价为止。这确保了用户在结束当天的学习前，对所有困难单词都有了初步的正确印象。

## 3. 应用于iOS App的初步算法设计

基于SM-2算法，我们可以为我们的俄语背单词App设计如下的记忆管理系统：

### 3.1 数据模型

需要为每个单词在本地数据库（如Core Data或SwiftData）中存储以下字段：

- `wordID`: 单词唯一标识符。
- `nextReviewDate`: `Date`类型，下一次需要复习的日期。
- `lastReviewedDate`: `Date`类型，上一次复习的日期。
- `repetitionCount`: `Int`, 对应SM-2中的 `n`。
- `easinessFactor`: `Double`, 对应SM-2中的 `EF`。
- `interval`: `Int`，上一次的复习间隔天数，对应SM-2中的 `I`。
- `isNew`: `Bool`，标记是否为新词。

### 3.2 每日学习计划生成

每天应用启动时，系统自动为用户生成当日的学习列表，列表包含两部分：

1.  **复习任务 (Review Queue)**:
    -   查询数据库，找出所有 `nextReviewDate <= 今天` 的单词。
    -   将这些单词加入复习队列。

2.  **新词任务 (New Word Queue)**:
    -   根据用户的每日学习目标（例如，每天学习20个新词）。
    -   从用户选择的词库中，按顺序提取 `N` 个 `isNew = true` 的单词。
    -   将这些单词加入新词队列。

### 3.3 学习流程

-   **优先复习**: 系统应引导用户优先完成复习任务。研究表明，先复习旧知识再学习新知识，有助于激活已有的知识网络，提高新知识的编码效率。
-   **执行与更新**: 
    -   用户每完成一个单词的复习或学习，根据其评分（`q`），调用上述SM-2算法逻辑，更新该单词的`repetitionCount`, `easinessFactor`, `interval`, 和 `nextReviewDate`。
    -   对于新词，完成第一次学习后，`isNew` 设为 `false`。
-   **动态调整**: `easinessFactor` 的存在本身就是一种动态调整机制。对于总是忘记的困难词，其EF会持续走低，导致复习间隔变短，出现频率增高。对于简单的词，EF会变高，复习间隔拉长，减少不必要的重复。

### 3.4 对SM-2的可能改进

虽然SM-2很经典，但也可以考虑一些现代化的改进：

- **时间因素**: 除了`q`，还可以引入用户的“反应时间”。反应时间过长，即使回答正确，也可能意味着记忆不牢固，可以适当降低`q`的等效值。
- **“失误”惩罚**: 对于因手滑等原因造成的“Oops”按钮，可以设计一个更温和的惩罚机制，比如不完全重置学习进度，而是将当前间隔打一个折扣（如50%）。
- **引入随机性**: 在安排复习时，可以引入微小的随机扰动，避免完全固定的间隔带来的枯燥感，并进一步探索记忆的边界。
